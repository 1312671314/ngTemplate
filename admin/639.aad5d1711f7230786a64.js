"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[639],{7639:(At,M,r)=>{r.r(M),r.d(M,{SettingModule:()=>bt});var B=r(2080),u=r(3423),c=r(665),t=r(7716),d=r(3630),z=r(2157),b=r(1147),A=r(8058),T=r(1636),g=r(3109),h=r(7018),y=r(1032),m=r(8542),_=r(4453),S=r(9374),f=r(4514),Z=r(5887),C=r(1244),O=r(7674),v=r(269),F=r(8583);function w(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}function U(a,s){if(1&a&&t._UZ(0,"nz-option",15),2&a){const e=s.$implicit;t.Q6J("nzLabel",e.name)("nzValue",e.id)}}function H(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",6,7),t.TgZ(3,"se",8),t.TgZ(4,"input",9),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().account.name=i}),t.qZA(),t.qZA(),t.TgZ(5,"se",10),t.TgZ(6,"nz-select",11),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().account.charactarId=i}),t.YNc(7,U,1,2,"nz-option",12),t.qZA(),t.qZA(),t.TgZ(8,"se",13),t.TgZ(9,"input",14),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().account.phone=i}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.validateForm),t.xp6(3),t.Q6J("ngModel",e.account.name),t.xp6(2),t.Q6J("ngModel",e.account.charactarId),t.xp6(1),t.Q6J("ngForOf",e.charactarList),t.xp6(2),t.Q6J("ngModel",e.account.phone)}}function P(a,s){if(1&a&&t._UZ(0,"nz-option",15),2&a){const e=s.$implicit;t.Q6J("nzLabel",e.name)("nzValue",e.id)}}function W(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",16,7),t.TgZ(3,"se",8),t.TgZ(4,"input",17),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().editAccount.name=i}),t.qZA(),t.qZA(),t.TgZ(5,"se",18),t.TgZ(6,"nz-select",19),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().editAccount.charactarId=i}),t.YNc(7,P,1,2,"nz-option",12),t.qZA(),t.qZA(),t.TgZ(8,"se",13),t.TgZ(9,"input",20),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().editAccount.phone=i}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.editAccount.name),t.xp6(2),t.Q6J("ngModel",e.editAccount.charactarId),t.xp6(1),t.Q6J("ngForOf",e.charactarList),t.xp6(2),t.Q6J("ngModel",e.editAccount.phone)}}let N=(()=>{class a{constructor(e,n,i,o,l,p,x,I,yt){this.http=e,this.modal=n,this.activeRoute=i,this.router=o,this.apiService=l,this.enumService=p,this.msg=x,this.fb=I,this.global=yt,this.total=0,this.pageIndex=1,this.pageSize=10,this.isVisible=!1,this.validateForm=I.group({name:[null,[c.kI.required]],phone:[null,[c.kI.required]],charactarId:[null,[c.kI.required]]}),this.isVisibleEdit=!1,this.account={},this.keyNameList=[{type:"index",name:"index"},{type:"text",name:"name"},{type:"text",name:"charactarName"},{type:"text",name:"phone"},{type:"time",name:"createTime"},{type:"text",name:"status"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1}]}],this.teadList=[{name:"\u5e8f\u53f7",type:"index"},{name:"\u59d3\u540d"},{name:"\u89d2\u8272"},{name:"\u624b\u673a\u53f7"},{name:"\u521b\u5efa\u65f6\u95f4"},{name:"\u72b6\u6001"},{name:"\u64cd\u4f5c"}]}isEmptyInputValue(e){return null==e||0===e.length}charactarSearch(){switch(this.category="PLATFORM",this.global.getUserInfo().category){case"ORG":this.category="ORG";break;case"OP":this.category="OP"}this.apiService.charactarSearch().then(e=>{if(e&&e.data){let n=[];e.data.forEach(i=>{i.category==this.category&&n.push(i)}),this.charactarList=n,console.log(e.data),this.charactarMap=this.enumService.getMap(n),this.getAccountList()}})}ngOnInit(){this.charactarSearch()}editFun(e){console.log(e),this.editAccount=JSON.parse(JSON.stringify(e)),this.isVisibleEdit=!0}add(){this.isVisible=!0}turnPage(e){this.pageIndex=e,this.getAccountList()}getAccountList(){let e={page:this.pageIndex-1,size:this.pageSize,categoryList:[this.category]};switch(this.global.getUserInfo().category){case"ORG":e={categoryList:[this.category],page:this.pageIndex-1,size:this.pageSize,orgId:this.global.getUserInfo().orgId};break;case"OP":e={categoryList:[this.category],page:this.pageIndex-1,size:this.pageSize,operateId:this.global.getUserInfo().operateId}}this.apiService.getAccountList(e).then(n=>{n&&n.data&&(n.data.content.forEach((i,o)=>{i.index=o,i.charactarText=this.charactarMap[i.charactarId],i.status=i.deleted?"\u7981\u7528":"\u6b63\u5e38\b"}),this.dataSet=n.data.content,this.total=n.data.totalElements)})}handleOk(){if(this.enumService.isMobile(this.account.phone)){switch(this.global.getUserInfo().category){case"ORG":this.account.orgId=this.global.getUserInfo().orgId;break;case"OP":this.account.operateId=this.global.getUserInfo().operateId}this.apiService.createAccount(this.account).then(e=>{e&&e.data?(this.isVisible=!1,this.ngOnInit(),this.msg.success("\u6dfb\u52a0\u6210\u529f"),this.account={}):(this.isVisible=!1,this.msg.error(e.message))})}else this.msg.error("\u624b\u673a\u53f7\u683c\u5f0f\u9519\u8bef")}handleCancel(){this.isVisible=!1}editOk(){this.apiService.accountUpdate({id:this.editAccount.id,name:this.editAccount.name}).then(e=>{e&&e.data?(this.isVisibleEdit=!1,this.ngOnInit(),this.msg.success("\u7f16\u8f91\u6210\u529f")):(this.isVisibleEdit=!1,this.msg.error(e.message))})}editCancel(){this.isVisibleEdit=!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.lP),t.Y36(d.Te),t.Y36(u.gz),t.Y36(u.F0),t.Y36(z.s),t.Y36(b.t),t.Y36(A.dD),t.Y36(c.qu),t.Y36(T.x))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-account"]],decls:9,vars:9,consts:[[3,"action"],["phActionTpl",""],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","editFuncOut","pageIndexOut"],["nzWidth","800px","nzTitle","\u64cd\u4f5c",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-button","","nzType","primary",3,"click"],["nz-form","","se-container","1",3,"formGroup"],["f","ngForm"],["label","\u59d3\u540d","error","\u8bf7\u8f93\u5165\u59d3\u540d!","required",""],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5165\u59d3\u540d","formControlName","name",3,"ngModel","ngModelChange"],["label","\u9009\u62e9\u89d2\u8272","required","","error","\u8bf7\u9009\u62e9\u89d2\u8272!"],["nzPlaceHolder","\u9009\u62e9\u89d2\u8272","formControlName","charactarId",2,"min-width","80px",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["label","\u624b\u673a\u53f7","error","\u8bf7\u8f93\u5165\u624b\u673a\u53f7!","required",""],["nz-input","","type","number","placeholder","\u8bf7\u8f93\u5165\u624b\u673a\u53f7","formControlName","phone",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue"],["nz-form","","se-container","1"],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5165\u59d3\u540d","name","name",3,"ngModel","ngModelChange"],["label","\u9009\u62e9\u89d2\u8272","required",""],["nzPlaceHolder","\u9009\u62e9\u89d2\u8272","disabled","","name","charactarId",2,"min-width","80px",3,"ngModel","ngModelChange"],["nz-input","","type","number","placeholder","\u8bf7\u8f93\u5165\u624b\u673a\u53f7","name","phone","disabled","",3,"ngModel","ngModelChange"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,w,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card"),t.TgZ(4,"table-template",2),t.NdJ("editFuncOut",function(o){return n.editFun(o)})("pageIndexOut",function(o){return n.turnPage(o)}),t.qZA(),t.qZA(),t.TgZ(5,"nz-modal",3),t.NdJ("nzVisibleChange",function(o){return n.isVisible=o})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(6,H,10,5,"ng-container",4),t.qZA(),t.TgZ(7,"nz-modal",3),t.NdJ("nzVisibleChange",function(o){return n.isVisibleEdit=o})("nzOnCancel",function(){return n.editCancel()})("nzOnOk",function(){return n.editOk()}),t.YNc(8,W,10,4,"ng-container",4),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(4),t.Q6J("dataList",n.dataSet)("theadList",n.teadList)("total",n.total)("pageIndex",n.pageIndex)("keyNameList",n.keyNameList)("pageSize",n.pageSize),t.xp6(1),t.Q6J("nzVisible",n.isVisible),t.xp6(2),t.Q6J("nzVisible",n.isVisibleEdit)}},directives:[g.q,h.bd,y.S,m.du,m.Hf,_.ix,S.dQ,f.w,c._Y,c.JL,Z.Lr,C.nV,c.sg,C.d_,O.Zp,c.Fj,c.JJ,c.u,v.Vq,F.sg,c.wV,v.Ip,c.F,c.On],encapsulation:2}),a})();function j(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}let L=(()=>{class a{constructor(e,n){this.http=e,this.modal=n}ngOnInit(){}add(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.lP),t.Y36(d.Te))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-role"]],decls:4,vars:1,consts:[[3,"action"],["phActionTpl",""],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,j,2,0,"ng-template",null,1,t.W1O),t.qZA(),t._UZ(3,"nz-card")),2&e){const i=t.MAs(2);t.Q6J("action",i)}},directives:[g.q,h.bd,_.ix,S.dQ,f.w],encapsulation:2}),a})();var J=r(4828);function $(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}function X(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",9,10),t.TgZ(3,"se",11),t.TgZ(4,"input",12),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().dictionaries.name=i}),t.qZA(),t.qZA(),t.TgZ(5,"se",13),t.TgZ(6,"input",14),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().dictionaries.unit=i}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.dictionaries.name),t.xp6(2),t.Q6J("ngModel",e.dictionaries.unit)}}function G(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",9,10),t.TgZ(3,"se",11),t.TgZ(4,"input",12),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().dictionaries.name=i}),t.qZA(),t.qZA(),t.TgZ(5,"se",15),t.TgZ(6,"input",16),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().dictionaries.level=i}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.dictionaries.name),t.xp6(2),t.Q6J("ngModel",e.dictionaries.level)}}let V=(()=>{class a{constructor(e,n,i,o,l,p,x){this.http=e,this.modal=n,this.activeRoute=i,this.router=o,this.apiService=l,this.enumService=p,this.msg=x,this.total=0,this.pageIndex=1,this.pageSize=10,this.isVisible=!1,this.pageIndexRiskSource=1,this.pageSizeRiskSource=10,this.isVisibleRiskSource=!1,this.typeIndex=0,this.dictionaries={},this.keyNameList=[{type:"index",name:"index"},{type:"text",name:"name"},{type:"text",name:"unit"},{type:"time",name:"createTime"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1}]}],this.teadList=[{name:"\u5e8f\u53f7"},{name:"\u540d\u79f0"},{name:"\u5355\u4f4d"},{name:"\u521b\u5efa\u65f6\u95f4"},{name:"\u64cd\u4f5c"}],this.keyNameList2=[{type:"index",name:"index"},{type:"text",name:"name"},{type:"text",name:"level"},{type:"time",name:"createTime"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1}]}],this.teadList3=[{name:"\u5e8f\u53f7"},{name:"\u540d\u79f0"},{name:"\u7b49\u7ea7"},{name:"\u521b\u5efa\u65f6\u95f4"},{name:"\u64cd\u4f5c"}],this.keyNameList3=[{type:"index",name:"index"},{type:"text",name:"name"},{type:"text",name:"level"},{type:"time",name:"createTime"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1}]}],this.teadList2=[{name:"\u5e8f\u53f7"},{name:"\u540d\u79f0"},{name:"\u7b49\u7ea7"},{name:"\u521b\u5efa\u65f6\u95f4"},{name:"\u64cd\u4f5c"}],this.operationMap={}}charactarSearch(){this.apiService.charactarSearch().then(e=>{e&&e.data&&(this.charactarList=e.data,this.charactarMap=this.enumService.getMap(e.data))})}getOperationList(){this.apiService.getOperationList().then(e=>{e&&e.data&&(this.operationMap=this.enumService.getMap(e.data))})}ngOnInit(){this.charactarSearch(),this.getOperationList(),this.equipmentInfoFindAll(),this.riskSourceFindAll()}editFun(e){console.log(e),this.dictionaries=JSON.parse(JSON.stringify(e)),this.isVisible=!0}editFun2(e){this.dictionaries=JSON.parse(JSON.stringify(e)),this.isVisibleRiskSource=!0}add(){console.log(this.typeIndex),0==this.typeIndex?this.isVisible=!0:this.isVisibleRiskSource=!0}equipmentInfoFindAll(){this.apiService.equipmentInfoFindAll().then(e=>{console.log(e),e&&e.data&&(e.data.forEach((n,i)=>{n.index=i}),this.dataSet=e.data)})}riskSourceFindAll(){this.apiService.riskSourceFindAll().then(e=>{console.log(e),e&&e.data&&(e.data.forEach((n,i)=>{n.index=i}),this.dataSetRiskSource=e.data)})}handleOk(){this.dictionaries&&this.dictionaries.id?this.apiService.equipmentInfoUpdate(this.dictionaries).then(e=>{e&&e.data?(this.isVisible=!1,this.dictionaries={},this.ngOnInit(),this.msg.success("\u64cd\u4f5c\u6210\u529f")):(this.isVisible=!1,this.msg.error("\u64cd\u4f5c\u5931\u8d25"))}):this.apiService.equipmentInfoCreate(this.dictionaries).then(e=>{e&&e.data?(this.isVisible=!1,this.dictionaries={},this.ngOnInit(),this.msg.success("\u64cd\u4f5c\u6210\u529f")):(this.isVisible=!1,this.msg.error("\u64cd\u4f5c\u5931\u8d25"))})}riskSourceOk(){this.dictionaries&&this.dictionaries.id?this.apiService.riskSourceUpdate(this.dictionaries).then(e=>{e&&e.data?(this.isVisibleRiskSource=!1,this.dictionaries={},this.ngOnInit(),this.msg.success("\u64cd\u4f5c\u6210\u529f")):(this.isVisibleRiskSource=!1,this.msg.error("\u64cd\u4f5c\u5931\u8d25"))}):this.apiService.riskSourceCreate(this.dictionaries).then(e=>{e&&e.data?(this.isVisibleRiskSource=!1,this.dictionaries={},this.ngOnInit(),this.msg.success("\u64cd\u4f5c\u6210\u529f")):(this.isVisibleRiskSource=!1,this.msg.error("\u64cd\u4f5c\u5931\u8d25"))})}handleCancel(){this.isVisible=!1,this.dictionaries={}}riskSourceCancel(){this.isVisibleRiskSource=!1,this.dictionaries={}}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.lP),t.Y36(d.Te),t.Y36(u.gz),t.Y36(u.F0),t.Y36(z.s),t.Y36(b.t),t.Y36(A.dD))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-dictionaries"]],decls:13,vars:16,consts:[[3,"action"],["phActionTpl",""],["nzType","card",3,"nzSelectedIndex","nzSelectedIndexChange"],["nzTitle","\u8bbe\u5907\u5b57\u5178"],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","editFuncOut"],["nzTitle","\u98ce\u9669\u6e90\u5b57\u5178"],["nzWidth","800px","nzTitle","\u64cd\u4f5c",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nz-button","","nzType","primary",3,"click"],["nz-form","","se-container","1"],["f","ngForm"],["label","\u5b57\u5178\u540d\u79f0","error","\u8bf7\u8f93\u5165\u5b57\u5178\u540d\u79f0!","required",""],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5165\u5b57\u5178\u540d\u79f0","name","name",3,"ngModel","ngModelChange"],["label","\u5b57\u5178\u5355\u4f4d","error","\u8bf7\u8f93\u5165\u5b57\u5178\u5355\u4f4d!","required",""],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5b57\u5178\u5165\u5355\u4f4d","name","unit",3,"ngModel","ngModelChange"],["label","\u98ce\u9669\u6e90\u7b49\u7ea7","error","\u8bf7\u8f93\u5165\u98ce\u9669\u6e90\u7b49\u7ea7!","required",""],["nz-input","","type","number","placeholder","\u8bf7\u8f93\u98ce\u9669\u6e90\u7b49\u7ea7(\u6574\u6570)","name","level",3,"ngModel","ngModelChange"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,$,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card"),t.TgZ(4,"nz-tabset",2),t.NdJ("nzSelectedIndexChange",function(o){return n.typeIndex=o}),t.TgZ(5,"nz-tab",3),t.TgZ(6,"table-template",4),t.NdJ("editFuncOut",function(o){return n.editFun(o)}),t.qZA(),t.qZA(),t.TgZ(7,"nz-tab",5),t.TgZ(8,"table-template",4),t.NdJ("editFuncOut",function(o){return n.editFun2(o)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"nz-modal",6),t.NdJ("nzVisibleChange",function(o){return n.isVisible=o})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(10,X,7,2,"ng-container",7),t.qZA(),t.TgZ(11,"nz-modal",6),t.NdJ("nzVisibleChange",function(o){return n.isVisibleRiskSource=o})("nzOnCancel",function(){return n.riskSourceCancel()})("nzOnOk",function(){return n.riskSourceOk()}),t.YNc(12,G,7,2,"ng-container",7),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(4),t.Q6J("nzSelectedIndex",n.typeIndex),t.xp6(2),t.Q6J("dataList",n.dataSet)("theadList",n.teadList)("total",n.total)("pageIndex",n.pageIndex)("keyNameList",n.keyNameList)("pageSize",n.pageSize),t.xp6(2),t.Q6J("dataList",n.dataSetRiskSource)("theadList",n.teadList2)("total",n.total)("pageIndex",n.pageIndexRiskSource)("keyNameList",n.keyNameList2)("pageSize",n.pageSizeRiskSource),t.xp6(1),t.Q6J("nzVisible",n.isVisible),t.xp6(2),t.Q6J("nzVisible",n.isVisibleRiskSource)}},directives:[g.q,h.bd,J.xH,J.xw,y.S,m.du,m.Hf,_.ix,S.dQ,f.w,c._Y,c.JL,c.F,Z.Lr,C.nV,C.d_,O.Zp,c.Fj,c.JJ,c.On,c.wV],encapsulation:2}),a})();var K=r(4295);function tt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}function et(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",7,8),t.TgZ(3,"se",9),t.TgZ(4,"input",10),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().operation.name=i}),t.qZA(),t.qZA(),t.TgZ(5,"se",11),t.TgZ(6,"location-select",12),t.NdJ("onLocationSelect",function(i){return t.CHM(e),t.oxw().onLocationSelect(i)}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.operation.name),t.xp6(2),t.Q6J("locationInfo",e.location)("sizes",8)}}function nt(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"table-template",13),t.NdJ("editFuncOut",function(i){return t.CHM(e),t.oxw().editFun2(i)}),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("dataList",e.dataSet2)("theadList",e.teadList2)("total",e.total2)("pageIndex",e.pageIndex2)("keyNameList",e.keyNameList2)("pageSize",e.pageSize2)}}let k=(()=>{class a{constructor(e,n,i,o,l,p){this.global=e,this.router=n,this.modal=i,this.apiService=o,this.msg=l,this.enumService=p,this.total=0,this.isVisibleAccount=!1,this.pageIndex2=1,this.pageSize2=10,this.total2=0,this.isEdit=!1,this.pageSize=10,this.pageIndex=1,this.isVisible=!1,this.keyNameList2=[{type:"index",name:"index"},{type:"text",name:"name"},{type:"text",name:"charactarName"},{type:"text",name:"phone"},{type:"time",name:"createTime"},{type:"text",name:"status"}],this.teadList2=[{name:"\u5e8f\u53f7",type:"index"},{name:"\u59d3\u540d"},{name:"\u89d2\u8272"},{name:"\u624b\u673a\u53f7"},{name:"\u521b\u5efa\u65f6\u95f4"},{name:"\u72b6\u6001"}],this.teadList=[{name:"\u5e8f\u53f7",type:"index"},{name:"\u8fd0\u8425\u4e2d\u5fc3"},{name:"\u8fd0\u8425\u4e2d\u5fc3\u7f16\u53f7"},{name:"\u533a\u57df"},{name:"\u521b\u5efa\u65f6\u95f4"},{name:"\u64cd\u4f5c",widthSet:!0}],this.keyNameList=[{type:"index",name:"index"},{type:"text",name:"name"},{type:"text",name:"serial"},{type:"text",name:"SSQ"},{type:"time",name:"createTime"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1},{text:"\u8d26\u53f7",index:2}]}],this.dataSet=[],this.locationConfig=T.x.getCityConfig(),this.location={provinceId:-1},this.operation={name:""}}ngOnInit(){this.charactarSearch(),this.getData()}add(){this.location={provinceId:-1},this.operation={name:""},this.isVisible=!0}onLocationSelect(e){this.location=e}handleOk(){this.location.name=this.operation.name,this.isEdit?(this.location.id=this.operation.id,this.apiService.updateOperation(this.location).then(e=>{e&&e.data?(this.isVisible=!1,this.isEdit=!1,this.ngOnInit(),this.msg.success("\u7f16\u8f91\u6210\u529f")):(this.isVisible=!1,this.msg.error("\u7f16\u8f91\u5931\u8d25"))})):this.apiService.addOperation(this.location).then(e=>{e&&e.data?(this.isVisible=!1,this.ngOnInit(),this.msg.success("\u6dfb\u52a0\u6210\u529f")):(this.isVisible=!1,this.msg.error("\u6dfb\u52a0\u5931\u8d25"))})}handleCancel(){this.isVisible=!1,this.isEdit=!1,this.operation.name="",this.location={provinceId:-1}}getData(){this.apiService.getOperationList().then(e=>{e&&e.data?(e.data.forEach((n,i)=>{n.index=i,n.SSQ=this.enumService.getSSQ(n.provinceId,n.cityId,n.districtId)}),this.dataSet=e.data):(this.dataSet=[],this.total=0)})}editFun(e){this.editItem2=e,1==e.btnIndex?(this.isEdit=!0,this.isVisible=!0,this.operation=e,this.location={provinceId:e.provinceId,cityId:e.cityId,districtId:e.districtId}):(this.isVisibleAccount=!0,this.getAccountList({page:this.pageIndex2-1,size:this.pageSize2,operateId:e.id}))}editFun2(e){}charactarSearch(){this.apiService.charactarSearch().then(e=>{if(e&&e.data){let n=[];e.data.forEach(i=>{"OP"==i.category&&n.push(i)}),this.charactarList=n,console.log(e.data),this.charactarMap=this.enumService.getMap(n)}})}getAccountList(e){this.apiService.getAccountList(e).then(n=>{n&&n.data&&(n.data.content.forEach((i,o)=>{i.index=o,i.charactarText=this.charactarMap[i.charactarId],i.status=i.deleted?"\u7981\u7528":"\u6b63\u5e38"}),this.dataSet2=n.data.content,this.total2=n.data.totalElements)})}onCancel(){this.isVisibleAccount=!1}turnPage(e){}turnPage2(e){this.pageIndex=e,this.getAccountList({page:this.pageIndex2-1,size:this.pageSize2,operateId:this.editItem2.id})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(T.x),t.Y36(u.F0),t.Y36(d.Te),t.Y36(z.s),t.Y36(A.dD),t.Y36(b.t))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-operation"]],decls:8,vars:10,consts:[[3,"action"],["phActionTpl",""],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","pageIndexOut","editFuncOut"],["nzWidth","1000px","nzTitle","\u64cd\u4f5c",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nzWidth","1000px","nzTitle","\u8fd0\u8425\u4e2d\u5fc3\u5b50\u8d26\u53f7",3,"nzVisible","nzFooter","nzVisibleChange","nzOnCancel"],["nz-button","","nzType","primary",3,"click"],["nz-form","","se-container","1"],["f","ngForm"],["label","\u8fd0\u8425\u4e2d\u5fc3\u540d\u79f0","error","\u8bf7\u8f93\u5165\u8fd0\u8425\u4e2d\u5fc3\u540d\u79f0!","required",""],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5165\u8fd0\u8425\u4e2d\u5fc3\u540d\u79f0","name","name",3,"ngModel","ngModelChange"],["label","\u9009\u62e9\u7701\u5e02\u533a\u5730\u533a","error","\u9009\u62e9\u7701\u5e02\u533a!","required",""],[3,"locationInfo","sizes","onLocationSelect"],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","editFuncOut"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,tt,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"table-template",2),t.NdJ("pageIndexOut",function(o){return n.turnPage(o)})("editFuncOut",function(o){return n.editFun(o)}),t.qZA(),t.TgZ(4,"nz-modal",3),t.NdJ("nzVisibleChange",function(o){return n.isVisible=o})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(5,et,7,3,"ng-container",4),t.qZA(),t.TgZ(6,"nz-modal",5),t.NdJ("nzVisibleChange",function(o){return n.isVisibleAccount=o})("nzOnCancel",function(){return n.onCancel()}),t.YNc(7,nt,2,6,"ng-container",4),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(3),t.Q6J("dataList",n.dataSet)("theadList",n.teadList)("total",n.total)("pageIndex",n.pageIndex)("keyNameList",n.keyNameList)("pageSize",n.pageSize),t.xp6(1),t.Q6J("nzVisible",n.isVisible),t.xp6(2),t.Q6J("nzVisible",n.isVisibleAccount)("nzFooter",null)}},directives:[g.q,y.S,m.du,m.Hf,_.ix,S.dQ,f.w,c._Y,c.JL,c.F,Z.Lr,C.nV,C.d_,O.Zp,c.Fj,c.JJ,c.On,K._],encapsulation:2}),a})();var E=r(6704),it=r(2079);function at(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}function ot(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",8,9),t.TgZ(3,"se",10),t.TgZ(4,"input",11),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().rule.setName=i}),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(4),t.Q6J("ngModel",e.rule.setName)}}function st(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"div",20),t._uU(2),t.qZA(),t.TgZ(3,"div",21),t.TgZ(4,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasPhone=i}),t._uU(5,"\u7535\u8bdd"),t.qZA(),t.qZA(),t.TgZ(6,"div",21),t.TgZ(7,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasSMS=i}),t._uU(8,"\u77ed\u4fe1"),t.qZA(),t.qZA(),t.TgZ(9,"div",21),t.TgZ(10,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasWebPush=i}),t._uU(11,"\u7f51\u9875\u63a8\u9001"),t.qZA(),t.qZA(),t.TgZ(12,"div",21),t.TgZ(13,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasWeixin=i}),t._uU(14,"\u5fae\u4fe1"),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=s.$implicit,n=t.oxw(3);t.xp6(2),t.Oqu(n.messageTypeMap[e.messageType]),t.xp6(2),t.Q6J("ngModel",e.hasPhone),t.xp6(3),t.Q6J("ngModel",e.hasSMS),t.xp6(3),t.Q6J("ngModel",e.hasWebPush),t.xp6(3),t.Q6J("ngModel",e.hasWeixin)}}function ct(a,s){if(1&a&&(t.TgZ(0,"div",16),t.TgZ(1,"p"),t.TgZ(2,"span",17),t._uU(3),t.qZA(),t.qZA(),t.YNc(4,st,15,5,"div",18),t.qZA()),2&a){const e=s.$implicit;t.xp6(3),t.hij(" ",e.levelName,"\u7ea7\u8054\u7cfb\u4eba "),t.xp6(1),t.Q6J("ngForOf",e.list)}}function rt(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",12),t.TgZ(2,"div",13),t._uU(3," \u89c4\u5219\u96c6\u540d\u79f0 "),t.qZA(),t.TgZ(4,"div",14),t.TgZ(5,"input",11),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().rule.setName=i}),t.qZA(),t.qZA(),t.qZA(),t.YNc(6,ct,5,2,"div",15),t.BQk()}if(2&a){const e=t.oxw();t.xp6(5),t.Q6J("ngModel",e.rule.setName),t.xp6(1),t.Q6J("ngForOf",e.noticeListAdd)}}function lt(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"div",20),t._uU(2),t.qZA(),t.TgZ(3,"div",21),t.TgZ(4,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasPhone=i}),t._uU(5,"\u7535\u8bdd"),t.qZA(),t.qZA(),t.TgZ(6,"div",21),t.TgZ(7,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasSMS=i}),t._uU(8,"\u77ed\u4fe1"),t.qZA(),t.qZA(),t.TgZ(9,"div",21),t.TgZ(10,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasWebPush=i}),t._uU(11,"\u7f51\u9875\u63a8\u9001"),t.qZA(),t.qZA(),t.TgZ(12,"div",21),t.TgZ(13,"label",22),t.NdJ("ngModelChange",function(i){return t.CHM(e).$implicit.hasWeixin=i}),t._uU(14,"\u5fae\u4fe1"),t.qZA(),t.qZA(),t.qZA()}if(2&a){const e=s.$implicit,n=t.oxw(3);t.xp6(2),t.Oqu(n.messageTypeMap[e.messageType]),t.xp6(2),t.Q6J("ngModel",e.hasPhone),t.xp6(3),t.Q6J("ngModel",e.hasSMS),t.xp6(3),t.Q6J("ngModel",e.hasWebPush),t.xp6(3),t.Q6J("ngModel",e.hasWeixin)}}function dt(a,s){if(1&a&&(t.TgZ(0,"div",16),t.TgZ(1,"p"),t.TgZ(2,"span",17),t._uU(3),t.qZA(),t.qZA(),t.YNc(4,lt,15,5,"div",18),t.qZA()),2&a){const e=s.$implicit;t.xp6(3),t.hij(" ",e.levelName,"\u7ea7\u8054\u7cfb\u4eba "),t.xp6(1),t.Q6J("ngForOf",e.list)}}function ut(a,s){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",12),t.TgZ(2,"div",13),t._uU(3," \u89c4\u5219\u96c6\u540d\u79f0 "),t.qZA(),t.TgZ(4,"div",14),t.TgZ(5,"input",11),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().editItem.setName=i}),t.qZA(),t.qZA(),t.qZA(),t.YNc(6,dt,5,2,"div",15),t.BQk()}if(2&a){const e=t.oxw();t.xp6(5),t.Q6J("ngModel",e.editItem.setName),t.xp6(1),t.Q6J("ngForOf",e.dataSetRule)}}let q=(()=>{class a{constructor(e,n,i,o,l,p,x){this.http=e,this.modal=n,this.activeRoute=i,this.router=o,this.apiService=l,this.enumService=p,this.msg=x,this.total=0,this.pageIndex=1,this.pageSize=10,this.pageIndex2=1,this.pageSize2=10,this.isVisibleAdd=!1,this.isVisibleEdit=!1,this.total2=0,this.messageTypeMap={FIRE_WARN:"\u9884\u8b66",EVENT:"\u4e8b\u4ef6",FIRE_ALARM:"\u544a\u8b66",DEVICE_FAULT:"\u6545\u969c"},this.account={},this.keyNameList=[{type:"index",name:"index"},{type:"text",name:"setName"},{type:"text",name:"typeName"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1}]}],this.teadList=[{name:"\u5e8f\u53f7",type:"index"},{name:"\u63a8\u9001\u89c4\u5219\u96c6"},{name:"\u89c4\u5219\u7c7b\u578b"},{name:"\u64cd\u4f5c"}],this.teadList2=[{name:"\u5e8f\u53f7"},{name:"\u7d27\u6025\u8054\u7cfb\u4eba"},{name:"\u901a\u77e5\u6e20\u9053"},{name:"\u6d88\u606f\u7c7b\u578b"},{name:"\u64cd\u4f5c"}],this.keyNameList2=[{type:"index",name:"index"},{type:"text",name:"levelName"},{type:"text",name:"hasText"},{type:"text",name:"messageTypeList"},{type:"buttonList",buttons:[{text:"\u7f16\u8f91",index:1}]}],this.operationMap={},this.rule={type:0},this.typeList=[{val:"0",name:"\u7cfb\u7edf\u9ed8\u8ba4"},{val:"1",name:"\u8fd0\u8425\u4e2d\u5fc3"}],this.isVisibleRule=!1}getOperationList(){this.apiService.getOperationList().then(e=>{e&&e.data&&(this.operationList=e.data,this.operationMap=this.enumService.getMap(e.data))})}ngOnInit(){this.notifyRuleSearchSetList(),this.charactarSearch();let[...e]=this.enumService.noticeList;this.noticeListAdd=e,this.noticeList=this.enumService.noticeList}charactarSearch(){this.apiService.charactarSearch().then(e=>{e&&e.data&&(this.charactarList=e.data,this.charactarMap=this.enumService.getMap(e.data))})}searchLevel(){this.apiService.searchLevel({setId:this.editItem.id}).then(e=>{console.log(e),e&&e.data?(e.data.forEach((n,i)=>{n.index=i,n.messageTypeList="",n.list.forEach(o=>{n.hasText="",o.messageType&&(n.messageTypeList+=this.messageTypeMap[o.messageType]),o.hasPhone&&(n.hasText+="\u7535\u8bdd/"),o.hasSMS&&(n.hasText+="\u90ae\u4ef6/"),o.hasWebPush&&(n.hasText+="\u7f51\u9875\u63a8\u9001/"),o.hasWeixin&&(n.hasText+="\u5fae\u4fe1\u63a8\u9001")})}),this.dataSetRule=0!=e.data.length?e.data:this.noticeList):this.dataSetRule=[]})}editFun(e){console.log(e),this.editItem=e,this.isVisibleEdit=!0,this.searchLevel()}editFun2(e){console.log(e),this.ruleList=e,this.isVisibleRule=!0}add(){this.dataSetRule=this.noticeList,this.isVisibleAdd=!0}notifyRuleSearchSetList(){this.apiService.notifyRuleSearchSetList({}).then(e=>{e&&e.data&&(e.data.forEach((n,i)=>{n.index=i,n.operateId&&(n.centerName=this.operationMap[n.operateId].name),n.typeName=n.type?"\u8fd0\u8425\u4e2d\u5fc3":"\u7cfb\u7edf\u9ed8\u8ba4"}),this.dataSet=e.data)})}handleOk(){this.apiService.createNotifyRuleSet(this.rule).then(e=>{e&&e.data?this.createRule(e.data):(this.isVisibleAdd=!1,this.msg.error("\u6dfb\u52a0\u5931\u8d25"))})}createRule(e){this.dataSetRule.forEach(n=>{n.type=this.editItem.type,n.operateInfoId=this.editItem.operateInfoId}),this.apiService.createLevel({list:this.dataSetRule,setId:e.id}).then(n=>{n&&n.data?(this.isVisibleEdit=!1,this.ngOnInit(),this.msg.success("\u6dfb\u52a0\u6210\u529f"),this.clearNotifyRule()):(this.isVisibleEdit=!1,this.msg.error("\u7f16\u8f91\u5931\u8d25"))})}editOk(){if(this.dataSetRule[0]&&this.dataSetRule[0].setId){let e=[];this.dataSetRule.forEach(n=>{n.list.forEach(i=>{e.push(i)})}),this.apiService.updateLevel({list:e}).then(n=>{n&&n.data?(this.isVisibleEdit=!1,this.ngOnInit(),this.msg.success("\u7f16\u8f91\u6210\u529f"),this.clearNotifyRule()):(this.isVisibleEdit=!1,this.msg.error("\u7f16\u8f91\u5931\u8d25"))})}else this.dataSetRule.forEach(e=>{e.type=this.editItem.type,e.operateInfoId=this.editItem.operateInfoId}),this.apiService.createLevel({list:this.dataSetRule,setId:this.editItem.id}).then(e=>{e&&e.data?(this.isVisibleEdit=!1,this.ngOnInit(),this.msg.success("\u7f16\u8f91\u6210\u529f"),this.clearNotifyRule()):(this.isVisibleEdit=!1,this.msg.error("\u7f16\u8f91\u5931\u8d25"))});this.updateSet()}clearNotifyRule(){this.apiService.clearNotifyRule().then(e=>{e&&e.success?console.log("\u6e05\u695a\u89c4\u5219\u7f13\u5b58\u6210\u529f"):console.log("\u6e05\u695a\u89c4\u5219\u7f13\u5b58\u5931\u8d25")})}updateSet(){this.apiService.updateSet({id:this.editItem.id,setName:this.editItem.setName}).then(e=>{e&&e.data?this.ngOnInit():this.msg.error("\u7f16\u8f91\u96c6\u5408\u540d\u79f0\u5931\u8d25")})}editCancel(){this.isVisibleEdit=!1}handleCancel(){this.isVisibleAdd=!1}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.lP),t.Y36(d.Te),t.Y36(u.gz),t.Y36(u.F0),t.Y36(z.s),t.Y36(b.t),t.Y36(A.dD))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-notice"]],decls:11,vars:10,consts:[[3,"action"],["phActionTpl",""],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","editFuncOut"],["nzWidth","800px","nzTitle","\u64cd\u4f5c",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nzWidth","1000px","nzTitle","\u6dfb\u52a0\u89c4\u5219\u96c6",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nzWidth","1000px","nzTitle","\u7f16\u8f91\u89c4\u5219",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-button","","nzType","primary",3,"click"],["nz-form","","se-container","1"],["f","ngForm"],["label","\u89c4\u5219\u96c6\u540d\u79f0","error","\u8bf7\u8f93\u5165\u89c4\u5219\u96c6\u540d\u79f0!","required",""],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5165\u89c4\u5219\u96c6\u540d\u79f0","name","setName",3,"ngModel","ngModelChange"],["nz-row","",2,"margin-bottom","20px"],["nz-col","",2,"width","160px","font-size","18px","font-weight","bold"],["nz-col","","nzSpan","12"],["style","border-bottom: 1px solid #eee;margin-bottom: 20px;padding-bottom: 10px;",4,"ngFor","ngForOf"],[2,"border-bottom","1px solid #eee","margin-bottom","20px","padding-bottom","10px"],[2,"font-size","18px","font-weight","bold"],["nz-row","",4,"ngFor","ngForOf"],["nz-row",""],["nz-col","",1,"gutter-row",2,"width","180px","text-align","right","padding-right","40px","font-size","16px","font-weight","bold"],["nz-col","",1,"gutter-row",2,"width","160px"],["nz-checkbox","",3,"ngModel","ngModelChange"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,at,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card"),t.TgZ(4,"table-template",2),t.NdJ("editFuncOut",function(o){return n.editFun(o)}),t.qZA(),t.qZA(),t.TgZ(5,"nz-modal",3),t.NdJ("nzVisibleChange",function(o){return n.isVisibleAdd=o})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(6,ot,5,1,"ng-container",4),t.qZA(),t.TgZ(7,"nz-modal",5),t.NdJ("nzVisibleChange",function(o){return n.isVisibleAdd=o})("nzOnCancel",function(){return n.handleCancel()})("nzOnOk",function(){return n.handleOk()}),t.YNc(8,rt,7,2,"ng-container",4),t.qZA(),t.TgZ(9,"nz-modal",6),t.NdJ("nzVisibleChange",function(o){return n.isVisibleEdit=o})("nzOnCancel",function(){return n.editCancel()})("nzOnOk",function(){return n.editOk()}),t.YNc(10,ut,7,2,"ng-container",4),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(4),t.Q6J("dataList",n.dataSet)("theadList",n.teadList)("total",n.total)("pageIndex",n.pageIndex)("keyNameList",n.keyNameList)("pageSize",n.pageSize),t.xp6(1),t.Q6J("nzVisible",n.isVisibleAdd),t.xp6(2),t.Q6J("nzVisible",n.isVisibleAdd),t.xp6(2),t.Q6J("nzVisible",n.isVisibleEdit)}},directives:[g.q,h.bd,y.S,m.du,m.Hf,_.ix,S.dQ,f.w,c._Y,c.JL,c.F,Z.Lr,C.nV,C.d_,O.Zp,c.Fj,c.JJ,c.On,E.SK,E.t3,F.sg,it.Ie],encapsulation:2}),a})();function pt(a,s){}let D=(()=>{class a{constructor(e,n,i,o,l){this.enumService=e,this.global=n,this.router=i,this.modal=o,this.apiService=l,this.total=0,this.pageSize=10,this.pageIndex=1,this.isVisible=!1,this.status="-1",this.operationMap={},this.locationConfig=T.x.getCityConfig(),this.location={provinceId:-1},this.teadList=[{name:"\u64cd\u4f5c\u4eba"},{name:"\u624b\u673a"},{name:"\u8d26\u53f7\u7c7b\u578b"},{name:"\u64cd\u4f5c\u5185\u5bb9"},{name:"\u64cd\u4f5c\u7c7b\u578b"},{name:"\u64cd\u4f5c\u65f6\u95f4"}],this.keyNameList=[{type:"text",name:"subjectName"},{type:"text",name:"subjectPhone"},{type:"text",name:"subjectType"},{type:"text",name:"content"},{type:"text",name:"processType"},{type:"time",name:"createTime"}],this.dataSet=[]}getOperationList(){this.apiService.getOperationList().then(e=>{e&&e.data&&(this.operationList=e.data,this.operationMap=this.enumService.getMap(e.data))})}ngOnInit(){this.getOperationList(),this.userTypeMap=this.enumService.userTypeMap,this.processTypeMap=this.enumService.processTypeMap,this.getData({page:this.pageIndex-1,size:this.pageSize,orgSerial:this.orgSerial,orgName:this.orgName,orgServeStatus:this.status,provinceId:this.location.provinceId,cityId:this.location.cityId,districtId:this.location.districtId,operateId:this.operateId})}onLocationSelect(e){this.location=e}rest(){this.operateId="",this.orgName="",this.orgSerial="",this.location={provinceId:"-1",cityId:"-1",districtId:"-1"},this.status="-1",this.getData({page:this.pageIndex-1,size:this.pageSize})}getData(e){e=this.apiService.filterData(e),this.apiService.processLogSearch(e).then(n=>{n&&n.data?(n.data.content.forEach(i=>{i.processType=this.processTypeMap[i.processType],"SYSTEM"==i.subjectType?(i.subjectType="\u5e73\u53f0",i.subjectName="\u7cfb\u7edf",i.checkRemark=i.content):i.subjectType=this.userTypeMap[i.subjectType]}),this.dataSet=n.data.content,this.total=n.data.totalElements):(this.dataSet=[],this.total=0)})}export(){}search(){let e={page:this.pageIndex-1,size:this.pageSize,orgSerial:this.orgSerial,orgName:this.orgName,orgServeStatus:this.status,provinceId:this.location.provinceId,cityId:this.location.cityId,districtId:this.location.districtId,operateId:this.operateId};e=this.apiService.filterData(e),this.getData(e)}editFun(e){this.router.navigate(["/org/org-detail"],{queryParams:{orgId:e.id}}),console.log(e)}handleCancel(){this.isVisible=!1}turnPage(e){this.getData({page:e-1,size:this.pageSize})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(b.t),t.Y36(T.x),t.Y36(u.F0),t.Y36(d.Te),t.Y36(z.s))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-diary"]],decls:5,vars:7,consts:[[3,"action"],["phActionTpl",""],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","pageIndexOut","editFuncOut"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,pt,0,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card"),t.TgZ(4,"table-template",2),t.NdJ("pageIndexOut",function(o){return n.turnPage(o)})("editFuncOut",function(o){return n.editFun(o)}),t.qZA(),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(4),t.Q6J("dataList",n.dataSet)("theadList",n.teadList)("total",n.total)("pageIndex",n.pageIndex)("keyNameList",n.keyNameList)("pageSize",n.pageSize)}},directives:[g.q,h.bd,y.S],encapsulation:2}),a})();var gt=r(8783),ht=r(3524);const mt=["st"];function _t(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}let Q=(()=>{class a{constructor(e,n){this.http=e,this.modal=n,this.url="/user",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.columns=[{title:"\u7f16\u53f7",index:"no"},{title:"\u8c03\u7528\u6b21\u6570",type:"number",index:"callNo"},{title:"\u5934\u50cf",type:"img",width:"50px",index:"avatar"},{title:"\u65f6\u95f4",type:"date",index:"updatedAt"},{title:"",buttons:[]}]}ngOnInit(){}add(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.lP),t.Y36(d.Te))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-operation-add"]],viewQuery:function(e,n){if(1&e&&t.Gf(mt,5),2&e){let i;t.iGM(i=t.CRH())&&(n.st=i.first)}},decls:7,vars:4,consts:[[3,"action"],["phActionTpl",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","columns"],["st",""],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"page-header",0),t.YNc(1,_t,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card"),t.TgZ(4,"sf",2),t.NdJ("formSubmit",function(l){return t.CHM(i),t.MAs(6).reset(l)})("formReset",function(l){return t.CHM(i),t.MAs(6).reset(l)}),t.qZA(),t._UZ(5,"st",3,4),t.qZA()}if(2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(4),t.Q6J("schema",n.searchSchema),t.xp6(1),t.Q6J("data",n.url)("columns",n.columns)}},directives:[g.q,h.bd,gt.kJ,ht.A5,_.ix,S.dQ,f.w],encapsulation:2}),a})();function St(a,s){if(1&a){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){return t.CHM(e),t.oxw().add()}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}let Y=(()=>{class a{constructor(e,n){this.http=e,this.modal=n}ngOnInit(){}add(){}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.lP),t.Y36(d.Te))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-push"]],decls:4,vars:1,consts:[[3,"action"],["phActionTpl",""],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,St,2,0,"ng-template",null,1,t.W1O),t.qZA(),t._UZ(3,"nz-card")),2&e){const i=t.MAs(2);t.Q6J("action",i)}},directives:[g.q,h.bd,_.ix,S.dQ,f.w],encapsulation:2}),a})();var ft=r(4755),Ct=r(1586);function Tt(a,s){}const xt=[{path:"account",component:N},{path:"role",component:L},{path:"dictionaries",component:V},{path:"operation",component:k},{path:"notice",component:q},{path:"diary",component:D},{path:"operation-add",component:Q},{path:"push",component:Y},{path:"message",component:(()=>{class a{constructor(e,n,i,o,l,p,x,I){this.enumService=e,this.global=n,this.router=i,this.modal=o,this.apiService=l,this.msg=p,this.events=x,this.noticeService=I,this.total=0,this.pageSize=10,this.pageIndex=1,this.isVisible=!1,this.status="-1",this.operationMap={},this.locationConfig=T.x.getCityConfig(),this.location={provinceId:-1},this.teadList=[{name:"\u6807\u9898"},{name:"\u516c\u53f8"},{name:"\u4e8b\u4ef6"},{name:"\u4f4d\u7f6e"},{name:"\u901a\u77e5\u7c7b\u578b"},{name:"\u65f6\u95f4"},{name:"\u72b6\u6001"},{name:"\u64cd\u4f5c"}],this.keyNameList=[{type:"text",name:"title"},{type:"text",name:"orgName"},{type:"text",name:"eventName"},{type:"text",name:"place"},{type:"text",name:"subjectType"},{type:"time",name:"createTime"},{type:"text",name:"markReadText"},{type:"buttonList",buttons:[{text:"\u8bbe\u7f6e\u5df2\u8bfb",index:1}]}],this.dataSet=[],this.messageStatusMap={}}getOperationList(){this.apiService.getOperationList().then(e=>{e&&e.data&&(this.operationList=e.data,this.operationMap=this.enumService.getMap(e.data))})}ngOnInit(){this.getOperationList(),this.messageStatusMap=this.enumService.messageStatausMap,this.userTypeMap=this.enumService.userTypeMap,this.processTypeMap=this.enumService.processTypeMap;let e={page:this.pageIndex-1,size:this.pageSize,accountId:this.global.getUserInfo().id};this.getData(e)}onLocationSelect(e){this.location=e}rest(){this.pageIndex=1;let e={page:this.pageIndex-1,size:this.pageSize,accountId:this.global.getUserInfo().id};this.getData(e)}getData(e){e=this.apiService.filterData(e),this.apiService.informSearch(e).then(n=>{n&&n.data?(n.data.content.forEach(i=>{i.subjectType=this.userTypeMap[i.messageType],i.markReadText=i.markRead?"\u5df2\u8bfb":"\u672a\u8bfb"}),this.dataSet=n.data.content,this.total=n.data.totalElements):(this.dataSet=[],this.total=0)})}allread(){this.apiService.informMarkRead({accountId:this.global.getUserInfo().id}).then(e=>{e&&e.success?(this.msg.success("\u64cd\u4f5c\u6210\u529f"),console.log("\u6d88\u606f\u6807\u8bb0\u5df2\u8bfb\u6210\u529f"),this.sendNotice(),this.search()):console.log("\u6d88\u606f\u6807\u8bb0\u5df2\u8bfb\u5931\u8d25")})}informMarkRead(e){this.apiService.informMarkRead(e).then(n=>{n&&n.success?(this.msg.success("\u64cd\u4f5c\u6210\u529f"),console.log("\u6d88\u606f\u6807\u8bb0\u5df2\u8bfb\u6210\u529f"),this.sendNotice(),this.search()):console.log("\u6d88\u606f\u6807\u8bb0\u5df2\u8bfb\u5931\u8d25")})}sendNotice(){this.noticeService.sub.next("new")}export(){}search(){let e={page:this.pageIndex-1,size:this.pageSize,accountId:this.global.getUserInfo().id};e=this.apiService.filterData(e),this.getData(e)}editFun(e){e.markRead?this.msg.info("\u6d88\u606f\u5df2\u8bfb"):this.informMarkRead({idList:[e.id]})}handleCancel(){this.isVisible=!1}turnPage(e){let n={page:e-1,size:this.pageSize,accountId:this.global.getUserInfo().id};this.getData(n)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(b.t),t.Y36(T.x),t.Y36(u.F0),t.Y36(d.Te),t.Y36(z.s),t.Y36(A.dD),t.Y36(ft.n),t.Y36(Ct.L))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-setting-message"]],decls:12,vars:7,consts:[[3,"action"],["phActionTpl",""],["nz-button","","nzType","primary",3,"click"],[1,"anticon","anticon-search"],[3,"dataList","theadList","total","pageIndex","keyNameList","pageSize","pageIndexOut","editFuncOut"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,Tt,0,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card"),t.TgZ(4,"div"),t.TgZ(5,"button",2),t.NdJ("click",function(){return n.search()}),t._UZ(6,"i",3),t._uU(7,"\u5237\u65b0 "),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return n.allread()}),t._UZ(9,"i",3),t._uU(10,"\u5168\u6807\u5df2\u8bfb "),t.qZA(),t.qZA(),t.TgZ(11,"table-template",4),t.NdJ("pageIndexOut",function(o){return n.turnPage(o)})("editFuncOut",function(o){return n.editFun(o)}),t.qZA(),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("action",i),t.xp6(11),t.Q6J("dataList",n.dataSet)("theadList",n.teadList)("total",n.total)("pageIndex",n.pageIndex)("keyNameList",n.keyNameList)("pageSize",n.pageSize)}},directives:[g.q,h.bd,_.ix,S.dQ,f.w,y.S],encapsulation:2}),a})()}];let zt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[u.Bz.forChild(xt)],u.Bz]}),a})(),bt=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[B.m8,zt]]}),a})()}}]);